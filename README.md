# Social-Distancing-and-Face-Mask-Monitor
# Introduction
Since the end of 2019, the COVID-19 pandemic has drastically affected the lives of people all around the world. The global economy has been deflating due to a loss of jobs, while face to face communication has been restricted to decrease the infection rate. Even though it has been six months, medical professionals are still unable to determine the end of the pandemic or when a vaccine will be developed. Based on this situation, scholars and researchers have pointed out that society will go through a long period of abnormality as governments continue to enforce social distancing and quarantines. This new way of life means many changes for us, such as online education, mandatory facial masks, and the vast majority of people working from home. 
In the current situation, people have begun to use artificial intelligence (AI) as a way to solve problems dealing with the pandemic. Johns Hopkins University Center for Systems Science and Engineering (CSSE) launched a global mapping website that tracks the spread of the virus, while in the medical field, image recognition software has been used to analyze viral gene sequences, which aids the effort of strain isolation. In almost all aspects of socially beneficial projects, AI technology has revealed its strong developmental potential.
Even though the concept and technique of social distancing and face mask detections have been proposed, the level of industrial development has not been reached. The contribution of this research is to present the industrial solution. Besides, we summarize the current challenges and possible solutions in the future work.

# Social Distancing Detector
Under the globe pandemic of COVID-19, social distancing has been emphasized as an effective measure to slow down the spread of the virus. Although most people remain at home, many essential workers in the transportation, manufacturing, and pharmaceutical industries still work even with the risk of infection. In order to make sure that such workers are safe, a monitoring system that checks for social distancing can be implemented. Andrew Ng’s Landing AI has developed a social distancing detection tool, presented in Figure 1, which uses AI technology to analyze real time video streams and detect whether people are keeping a safe distance apart in a public area. This social distancing tool applies a new class of surveillance technology that watches over people to make sure we keep a safe distance of at least six feet between each other in public areas. This system is realized through three major steps: calibration, detection, and measurement. In the stage of calibration, the monocular (single-camera) video stream can be transformed to a bird’s-eye view. The calibration method takes four points in the frame and maps them to the corners of a rectangle in the bird’s-eye view. During the detection stage, the system draws a bounding box around each pedestrian using an open-source R-CNN architecture based pedestrian detection network. Minimal post-processing is also applied to clean up the output bounding boxes in this stage. In the measurement stage, the coordinates (x, y) for each person’s location is estimated in the bird’s-eye view plane and then calculates the bird’s-eye view distance between every instance. When the distance is below the minimum acceptable distance, the system highlights these people in red and draws up a line between this pair of people to emphasize and issue a reminder to keep social distancing.  
This social distancing detection tool launched by Landing AI is aimed to help maintain distancing protocol in the workplace and public areas. For instance, at a factory could install this social distancing detection tool in their security camera systems to monitor the working circumstances. The detector would then highlight the people who are too close to each other in red on the monitor. The system can also issue a reminder to keep social distancing.
# Face Mask Detector
With the coronavirus quickly spreading, Centers for Disease Control has suggested people to wear cloth masks in public areas where social distancing would be difficult, such as subway and grocery stores. Adrian Rosebrock, a Ph.D. in Computer Science from University of Maryland Baltimore County, has built a face mask detector with OpenCV and Keras/ TensorFlow, which can be used to ensure people’s safety against virus. 
To use the COVID-19 face mask detector, two phases are involved: 
Training face mask detector. 
Applying face mask detector. 
 Using a dataset in order to train the face mask detector with Keras/ TensorFlow is crucial for the first phase. The dataset consists of 690 images labeled as “with_mask”, and 686 images as “without_mask”. In order to create a dataset for training the face mask detector, they take normal images of faces and have the AI detect facial landmarks to localize the position of the eyes, nose, and mouth. Then the AI is trained to detect if a mask is covering the face. In order to avoid the bias of model training, the original images are not reused to create the “without_mask” samples. After data preparation, the detection model can be 
trained by executing a Python script: > python train_mask_detector.py –dataset dataset. In the end, the serialized model is saved in the disk and the training outputs the plot of loss and accuracy to show how effective the trained model is.
In the phase of applying the AI, the detector is able to classify faces in the image as either “with_mask” or “without_mask” through running this Python Script: > python detect_mask_image.py --image imagetest_01.jpg. In the above command line, “--image” means the path to the input image containing faces that you want to detect. The output images are shown as Figure 2 and Figure 3 below. Additionally, this face mask detector can be implemented in real-time video stream using the following command:> python detect_mask_video.py. 
# Industrial Application Solution
Using the two detection AIs, a new system can be created to detect if people are keeping social distancing and wearing facial mask in public spaces. The execution processing flowchart of this system is indicated as Figure 4. Firstly, we input the real-time video to do social distancing checking as Figure 5. When two people are less than six feet apart, the system will be given “No” signal to capture a close-up image and utilize the face mask detection software. The output result is indicated as Figure 6. In this step, when the system detects “No Mask”, a “No” signal will be sent to trigger a voice of warning to remind the people to maintain social distancing and wear masks. Otherwise, the system will receive “Yes” signal to indicate that the situation is safe.
# Discussion
While the social distancing and face mask detection softwares can be used to control the spread of the virus, from a technical level there are still unresolved issues.  
Even though face mask detector has presented its remarkable performance with high accuracy, we still can see some bias in the output result of detection. In Figure 2, a blurry man wearing mask is misclassified as “No Mask” with 79.21% of probability. Furthermore, when the camera lens was pulled away to capture the whole image, nothing could be recognized by the software, as the image became too blurry for the AI to analyze properly. These detection biases are caused by the limitation of the dataset. Most of the images in the dataset are close-up images showing people’s faces and shoulders. We should expand the size and variety of the training set by adding images of different distances and angles.
In addition, it is meaningless to sound a warning when a couple or a family is detected by the social distancing detector. These groups of people are naturally closer to each other in both private and public places, meaning that they have a lesser impact on the community than strangers that are not social distancing. Therefore, we should utilize big data technique to analyze their relationships before the step of social distancing detection to increase the accuracy of detection.
Furthermore, the software will become less reliant in close quarters and inside buildings, due to the nature of the camera angles required. Usually, the wide angle views that the social distancing detector uses are only found on street and external cameras. Moreover, it can be seen in Figure 5 that certain cameras are simply unable to provide optimal circumstances for the software, as the positioning and quality of the camera has a major impact on the detection result. Thus, the next research will focus on creating a more flexible camera system and ways to adjust the workplace environment for the betterment of the software. 




